{% comment %}
  Custom product card for AJAX add-to-cart
  Used inside image-embedded-products section
{% endcomment %}

<div
  class="card-product-custom"
  data-product-card
  data-product-id="{{ product.id }}"
>
  <style>
    .card-product-custom { display: flex; gap: 12px; align-items: flex-start; padding: 12px; }
    .card-product-custom__media { flex: 0 0 auto; width: 64px; height: 64px; overflow: hidden; border-radius: 8px; }
    .card-product-custom__media img { width: 100%; height: 100%; object-fit: cover; display: block; }
    .card-product-custom__body { flex: 1 1 auto; display: flex; flex-direction: column; justify-content: space-between; min-width: 0; }
    .card-product-custom__info { margin-bottom: 8px; }
    .card-product-custom__title { margin: 0 0 6px; font-size: 1rem; font-weight: 600; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .card-product-custom__atc { width: 100%; margin-top: 8px; }
    @media screen and (max-width: 420px) {
      .card-product-custom { gap: 10px; padding: 10px; }
      .card-product-custom__media { width: 56px; height: 56px; }
    }
  </style>

  <div class="card-product-custom__media">
    {% if product.featured_media != blank %}
      {{ product.featured_media | image_url: width: 200, height: 200 | image_tag: alt: product.title }}
    {% else %}
      {% if product.featured_image != blank %}
        {{ product.featured_image | image_url: width: 200, height: 200 | image_tag: alt: product.title }}
      {% endif %}
    {% endif %}
  </div>

  <div class="card-product-custom__body">
    <div class="card-product-custom__info">
      <h3 class="card-product-custom__title">{{ product.title }}</h3>

      {% render 'price', product: product %}
    </div>

    <button
      type="button"
      class="button button--primary card-product-custom__atc"
      data-add-to-cart
      data-variant-id="{{ product.selected_or_first_available_variant.id }}"
      {% unless product.available %}
        disabled
      {% endunless %}
    >
      {% if product.available %}
        Add to cart
      {% else %}
        Sold out
      {% endif %}
    </button>
  </div>
</div>
